<!-- <p>oi yan </p> -->

<!doctype html>
<html lang="pt-BR">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>quicklist — Compras da semana</title>
  
  <link rel="stylesheet" href="styles/index.css">

</head>
<body>
  <div class="container">
    <div class="topbar">
      <a class="back" href="#" onclick="history.back();return false;" aria-label="Voltar">
        <span>← Voltar</span>
      </a>
      <div class="brand" aria-label="quicklist">
        <svg viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg" aria-hidden="true">
          <path d="M4 6h3" stroke="#d13b82" stroke-width="2" stroke-linecap="round"/>
          <rect x="8" y="5" width="12" height="2" rx="1" fill="#d13b82"/>
          <path d="M4 12h3" stroke="#d13b82" stroke-width="2" stroke-linecap="round"/>
          <rect x="8" y="11" width="12" height="2" rx="1" fill="#d13b82"/>
          <path d="M4 18h3" stroke="#d13b82" stroke-width="2" stroke-linecap="round"/>
          <rect x="8" y="17" width="12" height="2" rx="1" fill="#d13b82"/>
        </svg>
        quicklist
      </div>
    </div>

    <h1>Compras da semana</h1>

    <form id="add-form" class="add-form" autocomplete="off">
      <input id="item-input" class="input" type="text" placeholder="Adicione um novo item" aria-label="Adicione um novo item" />
      <button class="btn" type="submit">Adicionar item</button>
    </form>

    <ul id="list" class="list" aria-live="polite"></ul>
  </div>

  <div id="toast" class="toast" role="alert" aria-live="assertive" aria-atomic="true">
    <span class="badge">!</span>
    <span id="toast-msg">O item foi removido da lista</span>
    <button class="close" aria-label="Fechar aviso" title="Fechar">×</button>
  </div>

  <script>

    // quicklist — lógica básica 

    const STORAGE_KEY = 'quicklist-items-v1';

    /** @type {{id:string,text:string,done:boolean}[]} */
    let items = [];
    const formEl = document.getElementById('add-form');
    const inputEl = document.getElementById('item-input');
    const listEl  = document.getElementById('list');
    const toastEl = document.getElementById('toast');
    const toastMsg= document.getElementById('toast-msg');
    const toastClose = toastEl.querySelector('.close');

    // ---- persistência
   /* const load = () => {
      try { items = JSON.parse(localStorage.getItem(STORAGE_KEY) || '[]'); }
      catch { items = []; }
      if (!Array.isArray(items)) items = [];
      // Seed inicial se vazio
      if (items.length === 0) {
        items = [
          { id: uid(), text: 'Pão de forma', done: false },
          { id: uid(), text: 'Café preto', done: false },
          { id: uid(), text: 'Suco de laranja', done: false },
          { id: uid(), text: 'Bolacha', done: false },
        ];
        save();
      }
    };*/
    const save = () => localStorage.setItem(STORAGE_KEY, JSON.stringify(items));

    // ---- util
    function uid(){ return Math.random().toString(36).slice(2, 9) + Date.now().toString(36).slice(-3); }

    // ---- renderização
    function render(){
      listEl.innerHTML = '';
      items.forEach(item => listEl.appendChild(renderItem(item)));
    }

    function renderItem(item){
      const li = document.createElement('li');
      li.className = 'item' + (item.done ? ' done' : '');
      li.dataset.id = item.id;

      const check = document.createElement('input');
      check.type = 'checkbox';
      check.className = 'check';
      check.checked = item.done;
      check.setAttribute('aria-label', `Marcar ${item.text}`);

      const label = document.createElement('span');
      label.className = 'label';
      label.textContent = item.text;

      const del = document.createElement('button');
      del.className = 'del';
      del.setAttribute('aria-label', `Remover ${item.text}`);
      del.innerHTML = `<svg viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg" aria-hidden="true">
        <path d="M3 6h18" stroke="#9ca3af" stroke-width="2" stroke-linecap="round"/>
        <path d="M8 6v-1a2 2 0 0 1 2-2h4a2 2 0 0 1 2 2v1" stroke="#9ca3af" stroke-width="2"/>
        <rect x="6" y="8" width="12" height="12" rx="2" stroke="#9ca3af" stroke-width="2"/>
        <path d="M10 11v6M14 11v6" stroke="#9ca3af" stroke-width="2" stroke-linecap="round"/>
      </svg>`;

      // eventos
      check.addEventListener('change', () => {
        item.done = check.checked;
        li.classList.toggle('done', item.done);
        save();
      });

      del.addEventListener('click', () => {
        items = items.filter(i => i.id !== item.id);
        save();
        render();
        showToast('O item foi removido da lista');
      });

      li.append(check, label, del);
      return li;
    }

    // ---- formulário
    formEl.addEventListener('submit', (e) => {
      e.preventDefault();
      const text = inputEl.value.trim();
      if (!text) { inputEl.focus(); return; }
      items.push({ id: uid(), text, done:false });
      inputEl.value='';
      save();
      render();
    });

    // ---- toast
    let toastTimer;
    function showToast(message){
      toastMsg.textContent = message;
      toastEl.classList.add('show');
      clearTimeout(toastTimer);
      toastTimer = setTimeout(hideToast, 3000);
    }
    function hideToast(){ toastEl.classList.remove('show'); }
    toastClose.addEventListener('click', hideToast);

    // init
    load();
    render();
  </script>
</body>
</html>